<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LangkiTap Shop</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Outfit:wght@100..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Outfit:wght@100..900&family=Ubuntu+Sans:ital,wght@0,100..800;1,100..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style2.css') }}">
</head>
<body>
  <div class="page-container">
    <div class="main-content">
      <div class="user-catalog-v-4-3">
  <!-- Header -->
  <div class="header-and-title">
    <div class="navigation">
      <div class="items">
        <a class="home" href="{{ url_for('home') }}">Home</a>
        <a class="catalog2" href="{{ url_for('shop') }}">Catalog</a>
        <a class="about-us" href="{{ url_for('about') }}">About Us</a>
        
        {% if session.admin or session.user %}
        <div class="user-menu">
          <div class="user-button">
            {{ 'Admin' if session.admin else 'User' }} ▼
          </div>
          <div class="dropdown-content">
            <a href="{{ url_for('logout') }}">Logout</a>
            {% if session.admin %}
            <a href="{{ url_for('admin_page') }}">Admin Panel</a>
            <a href="{{ url_for('admin_catalog') }}">Manage Catalog</a>
            {% endif %}
            <a href="#">Profile</a>
          </div>
        </div>
        {% else %}
        <div class="button">
          <a class="login" href="{{ url_for('login') }}">Login</a>
        </div>
        {% endif %}
      </div>
      <div class="langki-tap">LangkiTap</div>
    </div>
  </div>
</div>

        <div class="catalog">Catalog</div>

        <!-- Body -->
        <div class="body">
          {% for category, items in categorized_products.items() %}
          <div class="category-section">
            <div class="category-title">{{ category }}</div>
            <div class="scroll-wrapper">
              <div class="scrollable-row">
                {% for item in items %}
                <!-- Product Card-->
                <div class="product-card-by-ralph2">
                  <img src="{{ url_for('static', filename='uploads/' + item.image) if item.image else url_for('static', filename='image_placeholder.png') }}">
                  <div class="frame-1321317465">
                    <div class="product-name">{{ item.name }}</div>
                    <div class="product-desc">{{ item.description }}</div>
                    <div class="product-price">${{ "%.2f"|format(item.price|float) }}</div>
                    <div class="add-to-cart" 
                         data-id="{{ item.id }}"
                         data-name="{{ item.name }}"
                         data-price="{{ item.price }}"
                         onclick="addToCart(this)">+ Add to cart</div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Footer and Checkout Container -->
    <div class="navigation-footer">
      <div class="social-icons">
        {% for i in range(4) %}
        <div class="buttons-icon"><img class="icon" src="{{ url_for('static', filename='icon' ~ i ~ '.svg') }}"></div>
        {% endfor %}
      </div>
      <div class="checkout">
        <div class="checkout-button" onclick="checkout()">
          <img class="basket-alt-3" src="{{ url_for('static', filename='basket-alt-30.svg') }}">
          <div class="checkout2">Checkout</div>
        </div>
        <div class="order-total">Order total: $<span id="total-price">0.00</span></div>
        <div class="cart-container">
          <div class="cart-items-wrapper">
            <div class="x-mug-2-cup-n-tshirt-xxx" id="cart-items">
              Your cart is empty
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    var cart = [];
    var total = 0;

    function addToCart(buttonElement) {
      var id = buttonElement.getAttribute('data-id');
      var name = buttonElement.getAttribute('data-name');
      var price = parseFloat(buttonElement.getAttribute('data-price'));
      
      cart.push({id: id, name: name, price: price});
      total += price;
      
      document.getElementById('total-price').textContent = total.toFixed(2);
      updateCartDisplay();
      
      buttonElement.textContent = '✓ Added';
      buttonElement.style.color = 'green';
      buttonElement.style.fontWeight = 'bold';
      setTimeout(function() {
        buttonElement.textContent = '+ Add to cart';
        buttonElement.style.color = '#a51d21';
        buttonElement.style.fontWeight = 'normal';
      }, 1000);
    }

    function updateCartDisplay() {
      var cartItemsElement = document.getElementById('cart-items');
      
      if (cart.length === 0) {
        cartItemsElement.innerHTML = 'Your cart is empty';
        return;
      }
      
      var itemsHTML = '';
      for (var i = 0; i < cart.length; i++) {
        itemsHTML += `
          <div class="cart-item" data-index="${i}">
            ${cart[i].name} - $${cart[i].price.toFixed(2)}
            <span class="remove-item" onclick="removeFromCart(${i})">✕</span>
          </div>
        `;
      }
      
      cartItemsElement.innerHTML = itemsHTML;
    }

    function removeFromCart(index) {
      if (index >= 0 && index < cart.length) {
        total -= cart[index].price;
        document.getElementById('total-price').textContent = total.toFixed(2);
        cart.splice(index, 1);
        updateCartDisplay();
      }
    }

    function checkout() {
      if (cart.length === 0) {
        alert('Your cart is empty!');
        return;
      }
      
      var itemNames = cart.map(function(item) {
        return item.name;
      }).join(', ');
      alert('Checkout complete! Total: $' + total.toFixed(2) + '\nItems: ' + itemNames);
      
      cart = [];
      total = 0;
      updateCartDisplay();
      document.getElementById('total-price').textContent = '0.00';
    }
  </script>
</body>
</html>